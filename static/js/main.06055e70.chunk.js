(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{16:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var c=n(8),o=n.n(c),r=(n(14),n(15),n(16),n(7)),a=n(2),i=n(1),s=n(9),u=n.n(s),l=n(0),d=n(4),f="https://mate.academy/students-api";function p(e){return new Promise((function(t){setTimeout(t,e)}))}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c={method:t};return n&&(c.body=JSON.stringify(n),c.headers={"Content-Type":"application/json; charset=UTF-8"}),p(300).then((function(){return fetch(f+e,c)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var j,m=function(e){return b(e)},h=function(e,t){return b(e,"POST",t)},O=function(e,t){return b(e,"PATCH",t)},v=function(e){return b(e,"DELETE")},g=function(e){return v("/todos/".concat(e))},x=function(e){var t=e.id,n=e.userId,c=e.title,o=e.completed;return O("/todos/".concat(t),{userId:n,title:c,completed:o})},y=function(e){var t=e.setErrorMassege,n=e.hideError,c=e.userId,o=e.addTodo,r=e.spinnerStatus,s=e.changeDate,u=e.changeCurrentId,f=e.setTodos,p=e.todos,b=e.isCompletedAllTodos,j=e.setSpinnerForTodos,m=Object(i.useState)(""),O=Object(a.a)(m,2),v=O[0],g=O[1],y=Object(i.useState)(!1),_=Object(a.a)(y,2),N=_[0],T=_[1],k=Object(i.useState)(!1),C=Object(a.a)(k,2),w=C[0],I=C[1],S=Object(i.useRef)(null);Object(i.useEffect)((function(){var e;w&&(null===(e=S.current)||void 0===e||e.focus())}),[w]);return Object(l.jsxs)("header",{className:"todoapp__header",children:[!!p.length&&Object(l.jsx)("button",{"aria-label":"change the completed of todos",type:"button",className:"todoapp__toggle-all ".concat(!b&&"active"),onClick:function(){if(b){t(""),r(!0),j(!0);var e=p.map((function(e){return x(Object(d.a)(Object(d.a)({},e),{},{completed:!0}))}));Promise.all(e).then((function(){return s(new Date)})).catch((function(){t("Unable to update a todos"),n()})).finally((function(){j(!1),r(!1)}))}if(!b){t(""),r(!0),j(!0);var c=p.map((function(e){return x(Object(d.a)(Object(d.a)({},e),{},{completed:!1}))}));Promise.all(c).then((function(){return s(new Date)})).catch((function(){t("Unable to update a todos"),n()})).finally((function(){j(!1),r(!1)}))}}}),Object(l.jsx)("form",{onSubmit:function(e){if(e.preventDefault(),T(!0),!v.trim())return t("Title can't be empty"),n(),void T(!1);var a={id:0,userId:c,title:v,completed:!1};I(!1),u(0),r(!0),o(a),function(e){var t=e.userId,n=e.title,c=e.completed;return h("/todos",{userId:t,title:n,completed:c})}(a).then((function(){g(""),r(!1),s(new Date)})).catch((function(){t("Unable to add a todo"),n(),f(p)})).finally((function(){T(!1),I(!0)}))},children:Object(l.jsx)("input",{ref:S,value:v,onChange:function(e){g(e.target.value)},disabled:N,type:"text",className:"todoapp__new-todo",placeholder:"What needs to be done?"})})]})},_=function(e){var t=e.todos,n=e.removeTodo,c=e.setErrorMassege,o=e.hideError,r=e.spinner,s=e.spinnerStatus,u=e.cuurentId,d=e.changeCurrentId,f=e.setDate,p=e.userId,b=e.spinnerForTodos,j=Object(i.useState)(null),m=Object(a.a)(j,2),h=m[0],O=m[1],v=function(e){s(!0),d(e),g(e).then((function(t){t&&n(e)})).catch((function(){c("Unable to delete a todo"),o()})).finally((function(){return s(!1)}))},y=Object(i.useRef)(null);Object(i.useEffect)((function(){var e;null===(e=y.current)||void 0===e||e.focus()}),[h]);return Object(l.jsx)("section",{className:"todoapp__main",children:t.map((function(e){var t=e.title,n=e.id,a=e.completed;return Object(l.jsxs)("div",{className:"todo ".concat(a&&"completed"),children:[Object(l.jsx)("label",{className:"todo__status-label",children:Object(l.jsx)("input",{type:"checkbox",className:"todo__status",onChange:function(e){return function(e,t,n){e.target.checked&&(c(""),s(!0),d(t),x({id:t,userId:p,title:n,completed:!0}).then((function(){return f(new Date)})).catch((function(){c("Unable to update a todo"),o()})).finally((function(){return s(!1)}))),e.target.checked||(c(""),s(!0),d(t),x({id:t,userId:p,title:n,completed:!1}).then((function(){return f(new Date)})).catch((function(){c("Unable to update a todo"),o()})).finally((function(){return s(!1)})))}(e,n,t)},checked:a})}),Object(l.jsx)(l.Fragment,{children:h!==n?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("span",{className:"todo__title",onDoubleClick:function(){return O(n)},children:t}),Object(l.jsx)("button",{onClick:function(){return v(n)},type:"button",className:"todo__remove",children:"\xd7"})]}):Object(l.jsx)("form",{onSubmit:function(e){return e.preventDefault()},children:Object(l.jsx)("input",{ref:y,type:"text",className:"todo__title-field",placeholder:"Empty todo will be deleted",defaultValue:t,onKeyUp:function(e){!function(e,t,n,r){if("Enter"===e.key){var a=e.currentTarget.value;if(r===a)return void O(null);if(!a.trim())return void v(t);c(""),s(!0),d(t),x({id:t,userId:p,title:a,completed:n}).then((function(){f(new Date),O(null)})).catch((function(){c("Unable to update a todo"),o()})).finally((function(){return s(!1)}))}"Escape"===e.key&&O(null)}(e,n,a,t)},onBlur:function(e){!function(e,t,n,r){var a=e.target.value;r!==a?(c(""),s(!0),d(t),x({id:t,userId:p,title:a,completed:n}).then((function(){f(new Date),O(null)})).catch((function(){c("Unable to update a todo"),o()})).finally((function(){return s(!1)}))):O(null)}(e,n,a,t)}})})}),Object(l.jsxs)("div",{className:"modal overlay ".concat((u===n||b||!!a)&&r&&"is-active"),children:[Object(l.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(l.jsx)("div",{className:"loader"})]})]},n)}))})};!function(e){e.all="All",e.active="Active",e.completed="Completed"}(j||(j={}));var N,T=function(e){var t=e.changeQuery,n=e.isCompletedTodo,c=e.numberActive,o=e.status,r=e.todos,a=e.setDate,i=e.setErrorMassege,s=e.setIsSpinner;return Object(l.jsxs)("footer",{className:"todoapp__footer",children:[Object(l.jsx)("span",{className:"todo-count",children:"".concat(c," items left")}),Object(l.jsxs)("nav",{className:"filter",children:[Object(l.jsx)("a",{onClick:function(){t(j.all)},href:"#/",className:"filter__link ".concat(o===j.all&&"selected"),children:"All"}),Object(l.jsx)("a",{onClick:function(){t(j.active)},href:"#/active",className:"filter__link ".concat(o===j.active&&"selected"),children:"Active"}),Object(l.jsx)("a",{onClick:function(){t(j.completed)},href:"#/completed",className:"filter__link ".concat(o===j.completed&&"selected"),children:"Completed"})]}),Object(l.jsx)("button",{style:n?{visibility:"visible"}:{visibility:"hidden"},type:"button",className:"todoapp__clear-completed",onClick:function(){s(!0);var e=r.map((function(e){return!!e.completed&&g(e.id)}));Promise.all(e).then((function(){return a(new Date)})).catch((function(){return i("Unable to delete a todos")})).finally((function(){return s(!1)}))},children:"Clear completed"})]})},k=11359;!function(e){e.all="All",e.active="Active",e.completed="Completed"}(N||(N={}));var C=function(){var e=Object(i.useState)([]),t=Object(a.a)(e,2),n=t[0],c=t[1],o=Object(i.useState)(""),s=Object(a.a)(o,2),d=s[0],f=s[1],p=Object(i.useState)(N.all),b=Object(a.a)(p,2),j=b[0],h=b[1],O=Object(i.useState)(!1),v=Object(a.a)(O,2),g=v[0],x=v[1],C=Object(i.useState)(0),w=Object(a.a)(C,2),I=w[0],S=w[1],E=Object(i.useState)(new Date),D=Object(a.a)(E,2),A=D[0],U=D[1],F=Object(i.useState)(!1),M=Object(a.a)(F,2),P=M[0],J=M[1],R=Object(i.useRef)(0),B=function(){R.current=window.setTimeout((function(){return f("")}),3e3)};Object(i.useEffect)((function(){var e;return(e=k,m("/todos?userId=".concat(e))).then(c).catch((function(){f("unable to load todos"),B()})),function(){return window.clearTimeout(R.current)}}),[A]);var Q=n.some((function(e){return e.completed})),G=n.some((function(e){return!e.completed})),H=Object(i.useMemo)((function(){return n.filter((function(e){return!e.completed})).length}),[n]);return Object(l.jsxs)("div",{className:"todoapp",children:[Object(l.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(l.jsxs)("div",{className:"todoapp__content",children:[Object(l.jsx)(y,{setErrorMassege:f,hideError:B,userId:k,addTodo:function(e){c((function(t){return[].concat(Object(r.a)(t),[e])}))},spinnerStatus:x,changeDate:U,changeCurrentId:S,setTodos:c,todos:n,isCompletedAllTodos:G,setSpinnerForTodos:J}),Object(l.jsx)(_,{todos:function(e){switch(e){case N.active:return n.filter((function(e){return!e.completed}));case N.completed:return n.filter((function(e){return e.completed}));default:return n}}(j),removeTodo:function(e){c((function(t){var n=t.filter((function(t){return t.id!==e}));return Object(r.a)(n)}))},setErrorMassege:f,hideError:B,spinner:g,spinnerStatus:x,cuurentId:I,changeCurrentId:S,setDate:U,userId:k,spinnerForTodos:P}),!!n.length&&Object(l.jsx)(T,{changeQuery:h,isCompletedTodo:Q,numberActive:H,status:j,todos:n,setDate:U,setErrorMassege:f,setIsSpinner:x})]}),d&&Object(l.jsxs)("div",{className:u()("notification is-danger is-light has-text-weight-normal",{hidden:!d}),children:[Object(l.jsx)("button",{onClick:function(){return f("")},type:"button",className:"delete"}),d]})]})};o.a.render(Object(l.jsx)(C,{}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.06055e70.chunk.js.map